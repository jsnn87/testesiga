<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Site com Layout Ajustável</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs" type="module"></script>
    <style>
        /* Estilos gerais */
        *,
        *:before,
        *:after {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #f8f3f3;
            font-family: Arial, sans-serif;
        }

        /* Layout principal */
        .main-container {
            display: flex;
            height: 95vh;
        }

        .content {
            flex: 100%;
            display: flex;
            flex-direction: column;
            gap: 1px;
            padding: 1px;
        }

        .container {
            padding: 30px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(128, 128, 128, 0.3);
            position: relative;
        }

        .flex-container {
            display: flex;
            gap: 10px;
            flex: 1;
        }

        .left-column {
            flex: 15%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .right-column {
            flex: 85%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .container2 {
            flex: 0.2;
            height: 100px;
        }

        .container3 {
            flex: 2.5;
            font-size: 12px;
            text-align: center;

        }

        .container4 {
            flex: 1;
        }

        .container5 {
            height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10px;
        }


        .container6 {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            font-size: 12px;
            text-align: center;
            overflow: hidden;
            width: 100%;
            height: 100%;
            padding: 10px;
            position: relative;
        }


        /* Estilos do Título */
        .container5 {
            height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10px;
            background-color: crimson;
            color: white;
        }

        .container5 h2 {
            font-size: 40px;
            font-weight: bold;
            margin: 0;
            text-align: center;
            color: crimson;
            color: white;
            
        }

        .container5 .sub-title {
            font-size: 20px;
            font-weight: normal;
            margin-top: 5px;
            color: white;
           
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                /* Tamanho normal */
            }

            50% {
                transform: scale(1.1);
                /* Aumenta o tamanho em 10% */
            }

            100% {
                transform: scale(1);
                /* Volta ao tamanho normal */
            }
        }

        .container4 h2 {
            margin-top: 0;
            /* Remove a margem superior padrão */
            padding-top: 5px;
            /* Adiciona um espaçamento no topo */
            text-align: center;
            /* Centraliza o texto */
            animation: pulse 0s infinite;
            /* Aplica a animação */
            font-size: 18px;
        }

        .container4 #eventoDoDia {
            font-size: 40px;
            /* Tamanho da fonte aumentado */
            font-weight: bold;
            /* Texto em negrito */
            text-align: center;
            /* Centraliza o texto */
            animation: pulse 2s infinite;
            /* Aplica a animação */
            color: #fff;
        }

        /* Sidebar global */
        nav {
            position: fixed;
            top: 70%;
            left: 0;
            transform: translateY(-50%);
            background: transparent;
            width: 70px;
            height: 70%;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1002
        }

        nav ul {
            text-align: center;
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 12px;
        }

        nav ul li {
            position: relative;
            width: 70px;
            height: 70px;
            cursor: pointer;
            background: crimson;
            text-transform: uppercase;
            transition: all 0.4s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        nav ul li:after {
            position: absolute;
            background: white;
            color: crimson;
            top: 0;
            left: 70px;
            width: 70px;
            height: 100%;
            opacity: .5;
            transform: perspective(400px) rotateY(90deg);
            transform-origin: 0 100%;
            transition: all 0.4s ease-out;
        }

        nav ul li:nth-child(1):after {
            content: "Status";
            line-height: 88px;
        }

        nav ul li:nth-child(2):after {
            content: "Agenda";
            line-height: 88px;
        }

        nav ul li:nth-child(3):after {
            content: "Registro";
            line-height: 85px;
        }

        nav ul li:nth-child(4):after {
            content: "Ação";
            line-height: 70px;
        }

        nav ul li:hover {
            transform: translateX(-70px);
        }

        nav ul li:hover:after {
            opacity: 1;
            transform: perspective(400px) rotateY(0deg) scale(1);
        }

        .fa-home,
        .fa-calendar,
        .fa-clipboard-list,
        .fa-bullhorn {
            font-size: 30px;
            color: white;
        }

        nav ul li:hover .fa-home,
        nav ul li:hover .fa-calendar,
        nav ul li:hover .fa-clipboard-list,
        nav ul li:hover .fa-bullhorn {
            color: crimson;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }

        /* Seções */
        section {
            margin-left: 70px;
            padding: 20px;
            display: none;
            height: 100vh;
        }

        section.active {
            display: block;
        }

        nav ul li.active {
            background-color: #333;
        }

        /* Estilos do Título */
        .fixed-title {
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 1;
            padding: 15px;
            border-bottom: 1px solid #ccc;
            margin-bottom: 20px;
        }

        /* Container da página Ação */
        .registro-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(128, 128, 128, 0.3);
            position: relative;
            overflow: hidden;
        }

        /* Sidebar dentro do container Ação */
        .registro-sidebar {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: transparent;
            z-index: 10;
            display: flex;
            justify-content: flex-end;
            align-items: flex-end;
        }

        .registro-sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            gap: 10px;
        }

        .registro-sidebar ul li {
            position: relative;
            width: 40px;
            height: 40px;
            cursor: pointer;
            background: crimson;
            text-transform: uppercase;
            transition: all 0.4s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
        }

        .registro-sidebar ul li.selecionado {
            background-color: #333 !important;
        }

        .registro-sidebar ul li.selecionado i {
            color: white !important;
        }

        .registro-sidebar ul li i {
            color: white;
            font-size: 24px;
        }

        .registro-sidebar ul li:hover {
            background: darkred;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 70%;
            max-width: 800px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid crimson;
            padding-bottom: 10px;
        }

        .modal-header h2 {
            font-size: 24px;
            color: crimson;
            margin: 0;
        }

        .modal-body {
            font-size: 18px;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: flex;
            align-items: center;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .form-group label i {
            margin-right: 10px;
            color: crimson;
        }

        .form-group input[type="text"],
        .form-group textarea,
        .form-group input[type="date"],
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input[type="text"]:focus,
        .form-group textarea:focus,
        .form-group input[type="date"]:focus,
        .form-group select:focus {
            border-color: crimson;
            outline: none;
        }

        .form-group textarea {
            resize: vertical;
            height: 300px;
        }

        .save-button {
            background-color: crimson;
            color: white;
            font-size: 16px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s ease;
        }

        .save-button:hover {
            background-color: darkred;
        }

        /* Estilos da tabela */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            flex: 1;
            margin: 0 auto;
            overflow-y: auto;
        }

        .data-table::-webkit-scrollbar {
            width: 10px;
        }

        .data-table::-webkit-scrollbar-thumb {
            background-color: crimson;
            border-radius: 5px;
        }

        .data-table th {
            background-color: crimson;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 1;
            white-space: nowrap;
            height: 60px;
            font-size: 20px;
            padding: 15px;
            text-align: center;
            vertical-align: middle;
        }

        .data-table td {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: center;
            vertical-align: middle;
            height: 80px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .data-table tr:hover {
            background-color: #f1f1f1;
        }

        .action-column {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            height: 50px;
            border: 1px solid #ccc;
        }

        .action-column i {
            cursor: pointer;
            font-size: 20px;
            position: relative;
        }

        .action-column i::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 5px;
            border-radius: 5px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .action-column i:hover::after {
            opacity: 1;
        }

        .action-column i.fa-check {
            color: green;
        }

        .action-column i.fa-edit {
            color: orange;
        }

        .action-column i.fa-trash {
            color: red;
        }

        .action-column i.fa-eye {
            color: #007bff;
        }

        /* Aumentar o tamanho do modal de visualização */
        #viewModal .modal-content {
            width: 100%;
            height: 80%;
            max-width: 1400px;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            background-color: #ffffff;
            overflow: hidden;
        }

        #viewModal .modal-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        #viewModal .modal-header h2 {
            font-size: 24px;
            color: #333;
            margin: 0;
            font-weight: bold;
        }

        #viewModal .modal-header i {
            margin-right: 10px;
            color: crimson;
            font-size: 28px;
        }

        /* Novo layout para o modal de visualização */
        #viewModal .modal-body {
            display: flex;
            flex-direction: column;
            gap: 20px;
            height: calc(100% - 60px);
        }

        /* Linha superior com Marca, O quê, Quem, Quando e Data de Registro */
        .info-row {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        /* Estilo para cada campo na linha superior */
        .info-row .info-box {
            flex: 1;
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            font-size: 24px;
        }

        /* Estilo para o campo Como */
        .como-box {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            width: 100%;
            flex: 1;
            font-size: 30px;
        }

        /* Efeito de hover nos campos */
        .info-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        /* Estilos para paginação */
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            gap: 10px;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #ccc;
            background-color: #f8f3f3;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            border-radius: 5px;
            font-size: 14px;
        }

        .pagination button.active {
            background-color: crimson;
            color: white;
            border-color: crimson;
        }

        .pagination button:hover:not(.active) {
            background-color: #ddd;
        }

        /* Animação de transição da tabela */
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .slide-right {
            animation: slideInRight 0.5s ease-out;
        }

        .slide-left {
            animation: slideInLeft 0.5s ease-out;
        }

        /* Sidebar Marcas */
        .sidebar-marcas {
            position: absolute;
            top: 0;
            right: 0;
            width: auto;
            background: transparent;
            z-index: 10;
            display: flex;
            justify-content: flex-end;
            align-items: flex-start;
            padding: 10px;
        }

        .sidebar-marcas ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: space-around;
        }

        .sidebar-marcas ul li {
            position: relative;
            width: 100px;
            height: 60px;
            cursor: pointer;
            background: crimson;
            text-transform: uppercase;
            transition: all 0.4s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 0 !important;
        }

        .sidebar-marcas ul li img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            transition: opacity 0.4s ease-out;
        }

        .sidebar-marcas ul li:first-child {
            border-top-left-radius: 10px;
            border-bottom-left-radius: 10px;
        }

        .sidebar-marcas ul li:last-child {
            border-top-right-radius: 10px;
            border-bottom-right-radius: 10px;
        }

        .sidebar-marcas ul li:hover img {
            opacity: 0;
        }

        .sidebar-marcas ul li:after {
            position: absolute;
            background: white;
            color: crimson;
            top: 100%;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transform: translateY(0);
            transition: all 0.4s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            font-weight: bold;
        }

        .sidebar-marcas ul li:nth-child(1):after {
            content: "ASICS";
        }

        .sidebar-marcas ul li:nth-child(2):after {
            content: "FILA";
        }

        .sidebar-marcas ul li:nth-child(3):after {
            content: "UMBRO";
        }

        .sidebar-marcas ul li:hover {
            background: transparent;
        }

        .sidebar-marcas ul li:hover:after {
            opacity: 1;
            transform: translateY(-100%);
        }

        /* Estilo para itens selecionados */
        .sidebar-marcas ul li.selecionado {
            background-color: #333 !important;
        }

        .sidebar-marcas ul li.selecionado img {
            filter: brightness(0) invert(1);
        }

        /* Toast */
        .toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
        }

        .toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @keyframes fadein {
            from {
                bottom: 0;
                opacity: 0;
            }

            to {
                bottom: 30px;
                opacity: 1;
            }
        }

        @keyframes fadeout {
            from {
                bottom: 30px;
                opacity: 1;
            }

            to {
                bottom: 0;
                opacity: 0;
            }
        }

        /* Estilo para o campo de ID (não editável) */
        #editId {
            background-color: #f0f0f0;
            /* Fundo cinza claro */
            color: #666;
            /* Texto cinza */
            cursor: not-allowed;
            /* Cursor de "não permitido" */
        }

        /* Estilos para o Lottie Player */
        .lottie-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            /* Fundo branco com 80% de transparência */
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1001;
        }

        .lottie-container.show {
            display: flex;
        }

        /* Container da página Ação */
        .acao-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(128, 128, 128, 0.3);
            position: relative;
            overflow: hidden;
        }

        /* Sidebar dentro do container Ação */
        .acao-sidebar {
            position: absolute;
            top: 0;
            right: 0;
            width: auto;
            background: transparent;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 10px;
        }

        .acao-sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: space-around;
        }

        .acao-sidebar ul li {
            position: relative;
            width: 100px;
            height: 60px;
            cursor: pointer;
            background: crimson;
            text-transform: uppercase;
            transition: all 0.4s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 0 !important;
        }

        /* Estado selecionado no sidebar */
        .acao-sidebar ul li.selecionado {
            background-color: #333 !important;
            /* Cinza escuro */
        }

        .acao-sidebar ul li.selecionado img {
            filter: white
                /* Inverte a cor da imagem para branco */
        }

        /* Estilos para os logos das marcas */
        .acao-sidebar ul li img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            transition: opacity 0.4s ease-out;
        }

        /* Arredondar bordas específicas */
        .acao-sidebar ul li:first-child {
            border-top-left-radius: 10px;
            border-bottom-left-radius: 10px;
        }

        .acao-sidebar ul li:last-child {
            border-top-right-radius: 10px;
            border-bottom-right-radius: 10px;
        }

        /* Esconde o logo ao passar o mouse */
        .acao-sidebar ul li:hover img {
            opacity: 0;
        }

        /* Remove estilos desnecessários */
        .acao-sidebar ul li:after {
            position: absolute;
            background: white;
            color: crimson;
            top: 100%;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transform: translateY(0);
            transition: all 0.4s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            font-weight: bold;
        }

        .acao-sidebar ul li:nth-child(1):after {
            content: "ASICS";
        }

        .acao-sidebar ul li:nth-child(2):after {
            content: "FILA";
        }

        .acao-sidebar ul li:nth-child(3):after {
            content: "UMBRO";
        }

        .acao-sidebar ul li:hover {
            background: transparent;
        }

        .acao-sidebar ul li:hover:after {
            opacity: 1;
            transform: translateY(-100%);
        }

        /* Estilos da tabela */
        #tabela-producao {
            flex: 1;
            overflow-y: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: auto;
            font-size: px;
        }

        th,
        table td {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: center;
        }

        th {
            background-color: crimson;
            color: white;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        /* Fixar o título da tabela */
        .fixed-title {
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 1;
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }

        /* Ícone de agrupar/desagrupar */
        .toggle-icon {
            cursor: pointer;
            color: #007bff;
            font-size: 24px;
        }

        /* Linha de total */
        .linha-total {
            font-weight: bold;
            background-color: #e0e0e0;
        }

        /* Animação de carregamento */
        .loading-animation2 {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.911);
            z-index: 100;
        }

        #data-hora-registro {
            font-size: 14px;
            color: gray;
            margin-left: 10px;
            font-style: italic;
        }


        /* Container da página agenda */
        .agenda-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(128, 128, 128, 0.3);
            position: relative;
        }

        /* Fixar o título da tabela */
        .fixed-title {
            position: sticky;
            top: 0;
            background-color: white;
            z-index: 1;
            padding: 15px 20px;
            border-bottom: 1px solid #ccc;
            display: flex;
            justify-content: space-between;
            align-items: center;

            border-radius: 8px 8px 0 0;
        }

        .fixed-title h2 {
            margin: 0;
            font-size: 24px;
            color: #040404;
        }

        /* Ajustes para o calendário */
        #calendar {
            flex: 1;
            overflow: auto;
            margin-top: 20px;
        }

        #calendar table {
            width: 100%;
            height: 100%;
            border-collapse: collapse;
        }

        #calendar th,
        #calendar td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }

        #calendar td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
            vertical-align: middle;
            height: 100px;
        }

        #calendar td {
            background-color: #fff;
            color: #050505;
        }

        #calendar .event-cell {
            vertical-align: top;

        }

        #calendar .date-number {
            font-weight: bold;
            font-size: 34px;
            color: #000000;
        }

        #calendar .event-text {
            font-size: 44px;
            font-weight: bold;
            color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 50%;
        }

        /* Estilo para o filtro */
        .filter-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-container label {
            font-weight: bold;
            color: #0e0e0e;
        }

        .filter-container select {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background-color: #fff;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .filter-container select:hover {
            border-color: #999;
        }

        .filter-container select:focus {
            outline: none;
            border-color: #949696;
            box-shadow: 0 0 5px rgba(192, 191, 191, 0.5);
        }

        /* Estilo para as células do número da semana e dos dias da semana */
        #calendar .week-number {
            width: 50px;
            /* Largura fixa e reduzida para a coluna N° Sem */
            background-color: #a8a6a6;
            /* Cinza claro */
            font-size: 24px;
            /* Tamanho da fonte maior */
            font-weight: bold;
            /* Texto em negrito */
            color: #000000;
        }

        #calendar th {
            width: calc((100% - 50px) / 5);
            /* Ajuste proporcional para as colunas dos dias da semana */
            background-color: #a8a6a6;
            /* Cinza claro */
            font-size: 24px;
            /* Tamanho da fonte maior */
            font-weight: bold;
            /* Texto em negrito */
            color: #000000;
        }

        /* Estilo para o contêiner de carregamento */
        .lottie-container2 {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.8);
            /* Fundo branco com 80% de transparência */
            z-index: 10;
            /* Garante que fique acima de tudo */
            border-radius: 10px;
            /* Bordas arredondadas para combinar com o contêiner */
        }

        .lottie-container2 dotlottie-player {
            width: 300px;
            height: 300px;
        }

        /* Animação de pulsação para a data e o evento */
        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        #calendar .pulse {
            animation: pulse 1.5s infinite;
            /* Aplica a animação de pulsação */
        }

        .barcode-field {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .barcode-field input[type="text"] {
            width: 100%;
            padding: 15px;
            font-size: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            transition: border-color 0.3s ease;
        }

        .barcode-field input[type="text"]:focus {
            border-color: crimson;
            outline: none;
        }

        .barcode-field i.fas.fa-barcode {
            font-size: 45px;
            color: crimson;
        }

        /* Feedback visual */
        .feedback {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 40px;
            border-radius: 10px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            z-index: 1000;
            display: none;
            opacity: 1;
            transition: opacity 1s ease-out;
        }

        .feedback.success {
            background-color: #4CAF50;
            /* Verde */
            color: white;
            /* Texto em branco */
        }

        .feedback.warning {
            background-color: #FFC107;
            /* Amarelo */
            color: black;
            /* Texto em preto */
        }

        .feedback.error {
            background-color: #f44336;
            /* Vermelho */
            color: white;
            /* Texto em branco */
        }

        .feedback.info {
            background-color: #e90404;
            /* Azul */
            color: white;
            /* Texto em branco */
        }

        .quadrados-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            /* Espaçamento entre os quadrados */
            margin-top: 20px;
        }

        .quadrados-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            /* Espaçamento entre os quadrados */
            margin-top: 20px;
        }

        .quadrado {
            width: calc(50% - 5px);
            /* Dois quadrados por linha com espaçamento */
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 10px;
            /* Bordas arredondadas */
            background-color: #e0e0e0;
            /* Cor de fundo */
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            /* Sombra suave */
        }

        .quadrado:nth-child(even) {
            background-color: #e0e0e0;
            /* Cor de fundo alternada */
        }

        .quadrado:hover {
            background-color: #d1d1d1;
            /* Cor de fundo ao passar o mouse */
        }

        /* Estilo para o quadrado verde */
        .green {
            background-color: #28a745 !important;
            /* Cor verde para o fundo */
            color: white !important;
            /* Texto branco */
        }

        .table-wrapper {
            width: 100%;
            height: calc(100% - 40px);
            overflow: auto;
            margin-top: 10px;
        }

        /* Estilos ajustados para a tabela dinâmica */
        .table-container-wrapper {
            width: 100%;
            height: calc(100% - 40px);
            overflow: auto;
            border: 1px solid rgba(128, 128, 128, 0.2);
            border-radius: 5px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .dynamic-table {
            width: 100%;
            min-width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            table-layout: auto;
        }

        .dynamic-table th,
        .dynamic-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            white-space: nowrap;
        }

        .dynamic-table th {
            position: sticky;
            top: 0;
            z-index: 10;
            color: white;
        }

        .date-header {
            background-color: crimson !important;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .turno-header {
            background-color: rgba(220, 20, 60, 0.9) !important;
            position: sticky;
            top: 25px;
            z-index: 10;
        }

        .setor-header {
            background-color: crimson !important;
            color: white !important;
            position: sticky;
            left: 0;
            z-index: 15;
            min-width: auto;
            width: auto;
            white-space: nowrap;
        }

        .setor-cell {
            text-align: left !important;
            font-weight: bold;
            background-color: #f2f2f2 !important;
            position: sticky;
            left: 0;
            z-index: 5;
            min-width: auto;
            width: auto;
            white-space: nowrap;
        }

        .presente {
            background-color: #d4edda;
        }

        .ausente {
            background-color: #f8d7da;
        }

        .percentage-cell {
            font-weight: bold;
            font-size: 11px;
            text-align: center;
            padding: 0 !important;
            width: 70px;
        }

        .percent-red {
            background-color: #f3071a;
            color: #fcfcfc;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .percent-yellow {
            background-color: #f7be04;
            color: #ffffff;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .percent-green {
            background-color: #00973a;
            color: #ffffff;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .percent-blue {
            background-color: #069bf1;
            color: #fcfcfc;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .total-header {
            background-color: crimson !important;
            color: white !important;
        }

        .percentage-row {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px 5px;
        }

        .loading {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid crimson;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .barcode-field {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .barcode-field input[type="text"] {
            width: 100%;
            padding: 15px;
            font-size: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            transition: border-color 0.3s ease;
        }

        .barcode-field input[type="text"]:focus {
            border-color: crimson;
            outline: none;
        }

        .barcode-field i.fas.fa-barcode {
            font-size: 45px;
            color: crimson;
        }

        /* Estilos para os ícones */
        .icone-check {
            color: #28a745;
            font-weight: bold;
            font-size: 22px;
        }

        .icone-x {
            color: #dc3545;
            font-weight: bold;
            font-size: 22px;
        }

        /* Estilos para mensagens de erro */
        .error-message {
            color: #dc3545;
            text-align: center;
            margin: 20px 0;
        }

        .retry-button {
            background-color: crimson;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            margin: 0 auto;
            transition: background-color 0.3s;
        }

        .retry-button:hover {
            background-color: #b01030;
        }

        @media (max-width: 768px) {
            .table-header-container {
                flex-direction: column;
                /* Empilha em telas pequenas */
                align-items: flex-start;
            }

            .filters-container {
                margin-left: 0;
                margin-top: 10px;
                width: 100%;
                justify-content: space-between;
            }

            .filters-container select {
                width: 48%;
                /* Ajuste para telas pequenas */
                min-width: auto;
            }
        }

        .table-header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 10px;
        }

        .table-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            text-align: center;
            flex-grow: 1;
            align-items: center;
        }

        .filters-container {
            display: flex;
            gap: 10px;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 12px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-left: 20px;
            /* Espaçamento entre título e filtros */
        }

        .filters-container select {
            padding: 6px 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background-color: white;
            font-size: 12px;
            min-width: 140px;
        }

        .filters-container label {
            font-size: 12px;
            font-weight: bold;
            color: #555;
            margin-right: 5px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 10px;
        }

        .table-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            flex-grow: 1;
            text-align: left;
            padding-left: 10px;
            text-align: center;
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <nav>
        <ul>
            <li id="statusNav" onclick="showPage('status')">
                <div><i class="fas fa-home"></i></div>
            </li>
            <li id="agendaNav" onclick="showPage('agenda')">
                <div><i class="fas fa-calendar"></i></div>
            </li>
            <li id="registroNav" onclick="showPage('registro')">
                <div><i class="fas fa-clipboard-list"></i></div>
            </li>
            <li id="acaoNav" onclick="showPage('acao')">
                <div><i class="fas fa-bullhorn"></i></div>
            </li>
        </ul>
    </nav>

    <!-- Seções -->
    <section id="status" class="page active">
        <div class="main-container">
            <div class="content">
                <div class="flex-container">
                    <div class="left-column">
                        <div class="container container2">
                            <div class="barcode-field">
                                <i class="fas fa-barcode"></i>
                                <input type="text" id="barcodeInput" placeholder="Digite o código de barras">
                            </div>
                        </div>
                        <div class="container container3">
                            <h2>Presença do dia</h2>
                            <div class="quadrados-container" id="quadradosContainer">
                                <!-- Os quadrados serão inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        <div class="container container4">
                            <h2>Apresentação do dia</h2>
                            <p id="eventoDoDia"></p>
                        </div>
                    </div>
                    <div class="right-column">
                        <div class="container container5">
                            <h2>SIGA</h2>
                            <div class="sub-title">Sistema integrado de gestão aplicada</div>
                        </div>
                        <div class="container container6">
                            
                            <div class="table-header-container">
                                <div class="table-title">Histórico de Presença</div>
                                <div class="filters-container">
                                    <div>
                                        <label for="monthFilter2">Mês:</label>
                                        <select id="monthFilter2"></select>
                                    </div>
                                    <div>
                                        <label for="brandFilter">Marca:</label>
                                        <select id="brandFilter"></select>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="table-container" class="table-wrapper">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="agenda" class="page">
        <div class="agenda-container">
            <div class="fixed-title">
                <h2>Calendário de Apresentação de Gerenciamento Diário</h2>
                <div class="filter-container">
                    <label for="monthFilter1">Filtrar por mês:</label>
                    <select id="monthFilter1" onchange="loadCalendar1()">
                        <option value="0">Todos os meses</option>
                        <option value="1">Janeiro</option>
                        <option value="2">Fevereiro</option>
                        <option value="3">Março</option>
                        <option value="4">Abril</option>
                        <option value="5">Maio</option>
                        <option value="6">Junho</option>
                        <option value="7">Julho</option>
                        <option value="8">Agosto</option>
                        <option value="9">Setembro</option>
                        <option value="10">Outubro</option>
                        <option value="11">Novembro</option>
                        <option value="12">Dezembro</option>
                    </select>
                </div>
            </div>
            <div id="calendar"></div>
            <!-- Contêiner de carregamento -->
            <div class="lottie-container" id="lottieLoadingContainer2">
                <dotlottie-player src="https://lottie.host/c306cfff-12a7-48cd-a5c4-5bc0f80f6003/6X1VG6ZT4B.lottie"
                    background="transparent" speed="1" style="width: 300px; height: 300px" loop autoplay>
                </dotlottie-player>
            </div>
        </div>
    </section>

    <section id="registro" class="page">
        <div class="registro-container">
            <h2 class="fixed-title">Plano de Ação</h2>

            <!-- Sidebar Marcas -->
            <div class="sidebar-marcas">
                <ul>
                    <li id="filtroASICS" onclick="filtrarTabela('ASICS')">
                        <div>
                            <img src="https://i.postimg.cc/gkYJWM1C/logo-das-marcas-page-0003-removebg-preview.png"
                                alt="ASICS">
                        </div>
                    </li>
                    <li id="filtroFILA" onclick="filtrarTabela('FILA')">
                        <div>
                            <img src="https://i.postimg.cc/HW0xFGv0/logo-das-marcas-page-0001-removebg-preview.png"
                                alt="FILA">
                        </div>
                    </li>
                    <li id="filtroUMBRO" onclick="filtrarTabela('UMBRO')">
                        <div>
                            <img src="https://i.postimg.cc/nrxLMTrQ/logo-das-marcas-page-0002-removebg-preview-1.png"
                                alt="UMBRO">
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Container da tabela -->
            <div id="plano-de-acao-container"></div>

            <!-- Pagination -->
            <div class="pagination" id="pagination"></div>

            <!-- Sidebar -->
            <div class="registro-sidebar">
                <ul>
                    <li id="filtroREGISTAR" onclick="openModal()">
                        <div><i class="fas fa-plus-circle"></i></div>
                    </li>
                    <li id="filtroHISTORICO" onclick="openHistoricoModal()">
                        <div><i class="fas fa-history"></i></div>
                    </li>
                </ul>
            </div>

            <!-- Lottie Animation Container para carregamento inicial da tabela -->
            <div class="lottie-container" id="lottieLoadingContainer">
                <dotlottie-player src="https://lottie.host/c306cfff-12a7-48cd-a5c4-5bc0f80f6003/6X1VG6ZT4B.lottie"
                    background="transparent" speed="1" style="width: 300px; height: 300px" loop
                    autoplay></dotlottie-player>
            </div>

            <!-- Lottie Animation Container para outras operações -->
            <div class="lottie-container" id="lottieOtherContainer">
                <dotlottie-player src="https://lottie.host/ced89c82-41d6-4a4d-9902-13a0272aefd7/RPhabeUr8d.lottie"
                    background="transparent" speed="1" style="width: 300px; height: 300px" loop
                    autoplay></dotlottie-player>
            </div>
        </div>
    </section>

    <!-- Modal de Registrar Ação -->
    <div id="myModal" class="modal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>Registrar Ação</h2>
            </div>
            <form id="actionForm">
                <div class="form-group">
                    <div class="form-group">
                        <label for="marca"><i class="fas fa-calendar-alt"></i> Marca</label>
                        <select id="marca" name="marca" required>
                            <option value="">Selecione uma marca</option>
                            <option value="ASICS">ASICS</option>
                            <option value="FILA">FILA</option>
                            <option value="UMBRO">UMBRO</option>
                        </select>
                    </div>
                    <label for="oQue"><i class="fas fa-question-circle"></i> O quê?</label>
                    <input type="text" id="oQue" name="oQue" placeholder="Descreva a ação..." required>
                </div>
                <div class="form-group">
                    <label for="como"><i class="fas fa-tasks"></i> Como?</label>
                    <textarea id="como" name="como" placeholder="Explique como será feito..." required></textarea>
                </div>
                <div class="form-group">
                    <label for="quem"><i class="fas fa-user"></i> Quem?</label>
                    <input type="text" id="quem" name="quem" placeholder="Responsável pela ação..." required>
                </div>
                <div class="form-group">
                    <label for="quando"><i class="fas fa-calendar-alt"></i> Quando?</label>
                    <input type="date" id="quando" name="quando" required>
                </div>
                <button type="button" class="save-button" onclick="submitAction()">Salvar</button>
            </form>
        </div>
    </div>

    <!-- Modal de Editar Ação -->
    <div id="editModal" class="modal" onclick="closeEditModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>Editar Ação</h2>
            </div>
            <form id="editActionForm">
                <div class="form-group">
                    <label for="editId"><i class="fas fa-id-card"></i> ID</label>
                    <input type="text" id="editId" name="editId" readonly>
                </div>
                <div class="form-group">
                    <label for="editMarca"><i class="fas fa-calendar-alt"></i> Marca</label>
                    <input type="text" id="editMarca" name="editMarca" required>
                </div>
                <div class="form-group">
                    <label for="editOQue"><i class="fas fa-question-circle"></i> O quê?</label>
                    <input type="text" id="editOQue" name="editOQue" placeholder="Descreva a ação..." required>
                </div>
                <div class="form-group">
                    <label for="editComo"><i class="fas fa-tasks"></i> Como?</label>
                    <textarea id="editComo" name="editComo" placeholder="Explique como será feito..."
                        required></textarea>
                </div>
                <div class="form-group">
                    <label for="editQuem"><i class="fas fa-user"></i> Quem?</label>
                    <input type="text" id="editQuem" name="editQuem" placeholder="Responsável pela ação..." required>
                </div>
                <div class="form-group">
                    <label for="editQuando"><i class="fas fa-calendar-alt"></i> Quando?</label>
                    <input type="date" id="editQuando" name="editQuando" required>
                </div>
                <button type="button" class="save-button" onclick="submitEditAction()">Salvar</button>
            </form>
        </div>
    </div>

    <!-- Modal de Visualização -->
    <div id="viewModal" class="modal" onclick="closeViewModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2><i class="fas fa-eye"></i> Visualizar Ação</h2>
            </div>
            <div id="viewModalContent" class="modal-body">
                <!-- Linha superior com Marca, O quê, Quem, Quando e Data de Registro -->
                <div class="info-row">
                    <div class="info-box">
                        <strong>Marca</strong>
                        <p id="viewMarca"></p>
                    </div>
                    <div class="info-box">
                        <strong>O quê?</strong>
                        <p id="viewOQue"></p>
                    </div>
                    <div class="info-box">
                        <strong>Quem?</strong>
                        <p id="viewQuem"></p>
                    </div>
                    <div class="info-box">
                        <strong>Quando?</strong>
                        <p id="viewQuando"></p>
                    </div>
                    <div class="info-box">
                        <strong>Data de Registro:</strong>
                        <p id="viewDataRegistro"></p>
                    </div>
                </div>
                <!-- Campo Como abaixo de todos -->
                <div class="info-box como-box">
                    <strong>Como?</strong>
                    <p id="viewComo"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Histórico -->
    <div id="historicoModal" class="modal" onclick="closeHistoricoModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2><i class="fas fa-history"></i> Histórico</h2>
            </div>
            <div class="modal-body">
                <div id="historicoTableContainer"></div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <section id="acao" class="page">
        <div class="acao-container">
            <span id="data-hora-registro"></span>
            <h2 class="fixed-title">Acompanhamento Semanal</h2>

            <!-- Sidebar dentro do container Ação -->
            <div class="acao-sidebar">
                <ul>
                    <li id="filtroASICS" onclick="filtrarTabela2('ASICS')">
                        <div>
                            <img src="https://i.postimg.cc/gkYJWM1C/logo-das-marcas-page-0003-removebg-preview.png"
                                alt="ASICS">
                        </div>
                    </li>
                    <li id="filtroFILA" onclick="filtrarTabela2('FILA')">
                        <div>
                            <img src="https://i.postimg.cc/HW0xFGv0/logo-das-marcas-page-0001-removebg-preview.png"
                                alt="FILA">
                        </div>
                    </li>
                    <li id="filtroUMBRO" onclick="filtrarTabela2('UMBRO')">
                        <div>
                            <img src="https://i.postimg.cc/nrxLMTrQ/logo-das-marcas-page-0002-removebg-preview-1.png"
                                alt="UMBRO">
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Animação de carregamento -->
            <div class="loading-animation2">
                <dotlottie-player src="https://lottie.host/c306cfff-12a7-48cd-a5c4-5bc0f80f6003/6X1VG6ZT4B.lottie"
                    background="transparent" speed="1" style="width: 300px; height: 300px" loop autoplay>
                </dotlottie-player>
            </div>

            <!-- Tabela de Acompanhamento Semanal -->
            <div id="tabela-producao"></div>
        </div>
    </section>

    <!-- Feedback visual -->
    <div id="feedback" class="feedback"></div>

    <script>
        let allRows = []; // Armazena todas as linhas da tabela
        let tableHeaders = []; // Armazena os cabeçalhos da tabela
        let currentPage = 1;
        const rowsPerPage = 10;
        const maxVisiblePages = 5; // Número máximo de páginas visíveis na paginação
        let currentFilter = null; // Armazena o filtro atual (marca selecionada)
        let filteredRows = []; // Armazena as linhas filtradas

        function showPage(page) {
            var sections = document.querySelectorAll('.page');
            sections.forEach(function (section) {
                section.classList.remove('active');
            });
            var activePage = document.getElementById(page);
            activePage.classList.add('active');
            var navItems = document.querySelectorAll('nav ul li');
            navItems.forEach(function (item) {
                item.classList.remove('active');
            });
            var activeNavItem = document.getElementById(page + "Nav");
            activeNavItem.classList.add('active');
        }

        var modal = document.getElementById("myModal");
        var editModal = document.getElementById("editModal");
        var viewModal = document.getElementById("viewModal");
        var historicoModal = document.getElementById("historicoModal");

        function openModal() {
            modal.style.display = "block";
        }

        function closeModal() {
            modal.style.display = "none";

            // Seleciona o bloco "REGISTRAR" no sidebar interno
            const registrarBlock = document.getElementById('filtroREGISTAR');
            if (registrarBlock) {
                registrarBlock.style.backgroundColor = 'crimson';
                const icon = registrarBlock.querySelector('i');
                if (icon) {
                    icon.style.color = 'white';
                }
            }
        }

        function openEditModal() {
            editModal.style.display = "block";
        }

        function closeEditModal() {
            editModal.style.display = "none";
        }

        function openViewModal() {
            viewModal.style.display = "block";
        }

        function closeViewModal() {
            viewModal.style.display = "none";
        }

        function openHistoricoModal() {
            renderHistoricoTable();
            historicoModal.style.display = "block";
        }

        function closeHistoricoModal() {
            historicoModal.style.display = "none";
        }

        function showToast(message) {
            const toast = document.getElementById("toast");
            toast.textContent = message;
            toast.classList.add("show");
            setTimeout(() => {
                toast.classList.remove("show");
            }, 3000);
        }

        function fetchDataAndRenderTable(isInitialLoad = false) {
            const url = "https://script.google.com/macros/s/AKfycbz086OfzsHq1mDCEsHTOZ_tBtIaKC6a8uj3ScR_Owqw9EgqfAtJGdPgy-KUHNwI0NrjUw/exec";

            // Exibe a animação Lottie de carregamento apenas no carregamento inicial
            if (isInitialLoad) {
                const lottieLoadingContainer = document.getElementById('lottieLoadingContainer');
                lottieLoadingContainer.classList.add('show');
            } else {
                const lottieOtherContainer = document.getElementById('lottieOtherContainer');
                lottieOtherContainer.classList.add('show');
            }

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    const { headers, rows } = data;
                    allRows = rows; // Armazena todas as linhas
                    tableHeaders = headers; // Armazena os cabeçalhos
                    filtrarTabela(currentFilter); // Renderiza a tabela com o filtro atual
                })
                .catch(error => {
                    console.error("Erro ao buscar dados:", error);
                    showToast("Erro ao carregar dados.");
                })
                .finally(() => {
                    // Oculta a animação Lottie após o carregamento
                    if (isInitialLoad) {
                        const lottieLoadingContainer = document.getElementById('lottieLoadingContainer');
                        lottieLoadingContainer.classList.remove('show');
                    } else {
                        const lottieOtherContainer = document.getElementById('lottieOtherContainer');
                        lottieOtherContainer.classList.remove('show');
                    }
                });
        }

        // Função para calcular a diferença de dias entre duas datas
        function getDaysDifference(dateString) {
            const today = new Date();
            const targetDate = new Date(dateString);
            const timeDifference = targetDate - today;
            const daysDifference = Math.ceil(timeDifference / (1000 * 60 * 60 * 24));
            return daysDifference;
        }

        // Função para determinar a cor com base na diferença de dias
        function getColorBasedOnDate(daysDifference) {
            if (daysDifference < 0) {
                return '#FFCCCC'; // Vermelho suave (data passada)
            } else if (daysDifference <= 3) {
                return '#FFFFCC'; // Amarelo suave (faltando 3 dias)
            } else if (daysDifference <= 5) {
                return '#FFD699'; // Laranja suave (faltando 5 dias)
            } else {
                return '#CCFFCC'; // Verde suave (faltando mais de 5 dias)
            }
        }

        // Modificar a função renderTable para aplicar as cores na linha inteira
        function renderTable(page, filterMarca = null) {
            const container = document.querySelector("#plano-de-acao-container");
            container.innerHTML = "";

            const table = document.createElement("table");
            table.classList.add("data-table");

            // Cria o cabeçalho da tabela
            const thead = document.createElement("thead");
            const headerRow = document.createElement("tr");

            // Adiciona as colunas de A a G (7 colunas)
            for (let i = 0; i < 7; i++) {
                const th = document.createElement("th");
                th.textContent = tableHeaders[i] || `Coluna ${String.fromCharCode(65 + i)}`; // A, B, C, D, E, F, G
                headerRow.appendChild(th);
            }

            // Adiciona a coluna de ações
            const actionHeader = document.createElement("th");
            actionHeader.textContent = "Ações";
            headerRow.appendChild(actionHeader);

            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Cria o corpo da tabela
            const tbody = document.createElement("tbody");

            const startIndex = (page - 1) * rowsPerPage;
            const endIndex = startIndex + rowsPerPage;

            // Filtra as linhas com base na marca selecionada e se a coluna H está vazia
            filteredRows = filterMarca
                ? allRows.filter(row => row[1] === filterMarca && !row[7]) // Verifica se a coluna H (índice 7) está vazia
                : allRows.filter(row => !row[7]); // Filtra apenas linhas com a coluna H vazia

            filteredRows.slice(startIndex, endIndex).forEach((row, index) => {
                const tr = document.createElement("tr");

                // Calcula a diferença de dias para a coluna "Quando" (supondo que seja a 5ª coluna)
                const daysDifference = getDaysDifference(row[5]);
                const color = getColorBasedOnDate(daysDifference);

                // Aplica a cor de fundo na linha inteira
                tr.style.backgroundColor = color;

                // Adiciona as colunas de A a G
                for (let i = 0; i < 7; i++) {
                    const td = document.createElement("td");
                    if (i === 5 || i === 6) {
                        // Colunas que possam ser datas
                        td.textContent = formatDateToDisplay(row[i]) || ""; // Formata a data para exibição
                    } else {
                        td.textContent = row[i] || "";
                    }
                    tr.appendChild(td);
                }

                // Adiciona a coluna de ações
                const actionCell = document.createElement("td");
                actionCell.classList.add("action-column");

                // Ícones da coluna Ações
                actionCell.innerHTML = `
            <i class="fas fa-check" data-tooltip="Concluir" onclick="markAsCompleted(${startIndex + index})"></i>
            <i class="fas fa-edit" data-tooltip="Editar" onclick="openEditModalWithData(${startIndex + index})"></i>
            <i class="fas fa-trash" data-tooltip="Excluir" onclick="deleteRow(${startIndex + index})"></i>
            <i class="fas fa-eye" data-tooltip="Visualizar" onclick="viewRow(${startIndex + index})"></i>
        `;
                tr.appendChild(actionCell);

                tbody.appendChild(tr);
            });

            table.appendChild(tbody);
            container.appendChild(table);

            updatePagination();
        }

        function renderHistoricoTable() {
            const container = document.querySelector("#historicoTableContainer");
            container.innerHTML = "";

            const table = document.createElement("table");
            table.classList.add("data-table");

            // Cria o cabeçalho da tabela
            const thead = document.createElement("thead");
            const headerRow = document.createElement("tr");

            // Adiciona as colunas de A a G (7 colunas)
            for (let i = 0; i < 7; i++) {
                const th = document.createElement("th");
                th.textContent = tableHeaders[i] || `Coluna ${String.fromCharCode(65 + i)}`; // A, B, C, D, E, F, G
                headerRow.appendChild(th);
            }

            // Adiciona a coluna de ações
            const actionHeader = document.createElement("th");
            actionHeader.textContent = "Ações";
            headerRow.appendChild(actionHeader);

            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Cria o corpo da tabela
            const tbody = document.createElement("tbody");

            // Filtra as linhas com base na marca selecionada e se a coluna H está preenchida
            const historicoRows = currentFilter
                ? allRows.filter(row => row[1] === currentFilter && row[7]) // Verifica se a coluna H (índice 7) está preenchida
                : allRows.filter(row => row[7]); // Filtra apenas linhas com a coluna H preenchida

            historicoRows.forEach((row, index) => {
                const tr = document.createElement("tr");

                // Adiciona as colunas de A a G
                for (let i = 0; i < 7; i++) {
                    const td = document.createElement("td");
                    if (i === 5 || i === 6) {
                        // Colunas que possam ser datas
                        td.textContent = formatDateToDisplay(row[i]) || ""; // Formata a data para exibição
                    } else {
                        td.textContent = row[i] || "";
                    }
                    tr.appendChild(td);
                }

                // Adiciona a coluna de ações
                const actionCell = document.createElement("td");
                actionCell.classList.add("action-column");

                // Ícones da coluna Ações
                actionCell.innerHTML = `
            <i class="fas fa-eye" data-tooltip="Visualizar" onclick="viewRowHistorico(${index})"></i>
        `;
                tr.appendChild(actionCell);

                tbody.appendChild(tr);
            });

            table.appendChild(tbody);
            container.appendChild(table);
        }

        // Função para visualizar uma linha no modal de histórico
        function viewRowHistorico(index) {
            const historicoRows = currentFilter
                ? allRows.filter(row => row[1] === currentFilter && row[7]) // Verifica se a coluna H (índice 7) está preenchida
                : allRows.filter(row => row[7]); // Filtra apenas linhas com a coluna H preenchida

            const rowData = historicoRows[index]; // Obtém os dados da linha clicada

            // Verifica se os dados foram encontrados
            if (!rowData) {
                showToast("Dados da linha não encontrados.");
                return;
            }

            // Preenche os campos do modal de visualização
            document.getElementById("viewMarca").textContent = rowData[1] || "N/A";
            document.getElementById("viewOQue").textContent = rowData[2] || "N/A";
            document.getElementById("viewComo").textContent = rowData[3] || "N/A";
            document.getElementById("viewQuem").textContent = rowData[4] || "N/A";
            document.getElementById("viewQuando").textContent = formatDateToDisplay(rowData[5]) || "N/A";
            document.getElementById("viewDataRegistro").textContent = formatDateToDisplay(rowData[6]) || "N/A";

            // Abre o modal de visualização
            openViewModal();
            closeHistoricoModal();
        }

        function updatePagination() {
            const pagination = document.getElementById("pagination");
            pagination.innerHTML = "";

            const totalPages = Math.ceil(filteredRows.length / rowsPerPage);
            if (totalPages <= 1) return; // Se só tem 1 página, não mostra nada

            const prevButton = document.createElement("button");
            prevButton.textContent = "Anterior";
            prevButton.addEventListener("click", () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderTable(currentPage, currentFilter);
                    animateTable('left');
                }
            });
            pagination.appendChild(prevButton);

            const startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            const endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            for (let i = startPage; i <= endPage; i++) {
                const button = document.createElement("button");
                button.textContent = i;
                if (i === currentPage) button.classList.add("active");
                button.addEventListener("click", () => {
                    currentPage = i;
                    renderTable(i, currentFilter);
                });
                pagination.appendChild(button);
            }

            const nextButton = document.createElement("button");
            nextButton.textContent = "Próximo";
            nextButton.addEventListener("click", () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderTable(currentPage, currentFilter);
                    animateTable('right');
                }
            });
            pagination.appendChild(nextButton);
        }

        // Animação da tabela ao trocar de página
        function animateTable(direction) {
            const container = document.querySelector("#plano-de-acao-container");
            if (direction === 'right') {
                container.classList.remove('slide-left');
                container.classList.add('slide-right');
            } else if (direction === 'left') {
                container.classList.remove('slide-right');
                container.classList.add('slide-left');
            }
            setTimeout(() => {
                container.classList.remove('slide-right', 'slide-left');
            }, 500);
        }

        // Abre o modal de edição com os dados da linha selecionada
        function openEditModalWithData(index) {
            const rowData = filteredRows[index];

            document.getElementById("editId").value = rowData[0]; // Preenche o campo ID (não editável)
            document.getElementById("editMarca").value = rowData[1];
            document.getElementById("editOQue").value = rowData[2];
            document.getElementById("editComo").value = rowData[3];
            document.getElementById("editQuem").value = rowData[4];

            // Formata a data no formato dd/mm/aa para o campo 'Quando'
            const whenDate = formatForInputDate(rowData[5]);
            document.getElementById("editQuando").value = whenDate;

            openEditModal();
        }

        // Função para formatar a data para o formato dd/mm/aa (campo de input date)
        function formatForInputDate(dateString) {
            if (!dateString) return "";
            const [day, month, year] = dateString.split('/'); // Supondo que a data esteja no formato dd/mm/yyyy
            const shortYear = year.slice(-2); // Pega os dois últimos dígitos do ano
            return `${day}/${month}/${shortYear}`;
        }

        // Visualiza uma linha
        function viewRow(index) {
            const rowData = filteredRows[index]; // Obtém os dados da linha clicada

            // Verifica se os dados foram encontrados
            if (!rowData) {
                showToast("Dados da linha não encontrados.");
                return;
            }

            // Preenche os campos do modal de visualização
            document.getElementById("viewMarca").textContent = rowData[1] || "N/A";
            document.getElementById("viewOQue").textContent = rowData[2] || "N/A";
            document.getElementById("viewComo").textContent = rowData[3] || "N/A";
            document.getElementById("viewQuem").textContent = rowData[4] || "N/A";
            document.getElementById("viewQuando").textContent = formatDateToDisplay(rowData[5]) || "N/A";
            document.getElementById("viewDataRegistro").textContent = formatDateToDisplay(rowData[6]) || "N/A";

            // Abre o modal de visualização
            openViewModal();
        }

        // Formata data (string) em DD/MM/YY
        function formatDateToDisplay(dateString) {
            if (!dateString || isNaN(new Date(dateString))) {
                return "";
            }
            const date = new Date(dateString);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = String(date.getFullYear()).slice(-2);
            return `${day}/${month}/${year}`;
        }

        // Formata a data pra usar em <input type="date"> (YYYY-MM-DD)
        function formatForInputDate(dateString) {
            if (!dateString) return "";
            const [day, month, year] = dateString.split('/');
            const fullYear = `20${year}`; // Adiciona "20" para anos como "23" -> "2023"
            return `${fullYear}-${month}-${day}`;
        }

        // Salva a edição da ação (ainda não envia para servidor, se quiser enviar, faça outro fetch)
        function submitEditAction() {
            const editActionForm = document.getElementById('editActionForm');

            // Recupera os valores dos campos
            let formData = {
                id: editActionForm.editId.value,  // ID não editável, mas enviado no formulário
                marca: editActionForm.editMarca.value,
                oQue: editActionForm.editOQue.value,
                como: editActionForm.editComo.value,
                quem: editActionForm.editQuem.value,
                quando: editActionForm.editQuando.value
            };

            // Verifica se algum campo obrigatório está vazio
            if (!formData.marca || !formData.oQue || !formData.como || !formData.quem || !formData.quando) {
                showToast("Por favor, preencha todos os campos obrigatórios.");
                return; // Impede o envio dos dados caso algum campo esteja vazio
            }

            // Exibe a animação Lottie para outras operações
            const lottieOtherContainer = document.getElementById('lottieOtherContainer');
            lottieOtherContainer.classList.add('show');

            // Envia a requisição para o Google Apps Script
            fetch('https://script.google.com/macros/s/AKfycbz086OfzsHq1mDCEsHTOZ_tBtIaKC6a8uj3ScR_Owqw9EgqfAtJGdPgy-KUHNwI0NrjUw/exec', {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({
                    action: 'editRow', // Ação de edição
                    id: formData.id,  // ID da linha a ser atualizada
                    marca: formData.marca,
                    oQue: formData.oQue,
                    como: formData.como,
                    quem: formData.quem,
                    quando: formatDateForInput(formData.quando) // Garantindo o formato correto para o campo de data
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => {
                    console.log('Dados editados com sucesso:', response);
                    closeEditModal();
                    fetchDataAndRenderTable(); // Atualiza a tabela após editar
                    showToast("Ação editada com sucesso!");
                })
                .catch(error => {
                    console.error('Erro ao editar:', error);
                    showToast("Erro ao editar a ação.");
                }).finally(() => {
                    // Oculta a animação Lottie após o processo
                    lottieOtherContainer.classList.remove('show');
                });
        }

        // Função para formatar a data no formato YYYY-MM-DD
        function formatDateForInput(dateString) {
            if (!dateString) return ""; // Retorna vazio se a data não for fornecida
            const [day, month, year] = dateString.split('/');
            return `${year}-${month}-${day}`; // Retorna no formato YYYY-MM-DD
        }
        // Filtra a tabela por marca
        function filtrarTabela(marca) {
            // Remove a classe 'selecionado' de todos
            const marcaItems = document.querySelectorAll('.sidebar-marcas ul li');
            marcaItems.forEach(item => item.classList.remove('selecionado'));

            const selectedItem = document.getElementById(`filtro${marca}`);
            if (selectedItem) {
                selectedItem.classList.add('selecionado');
            }

            currentFilter = marca;
            currentPage = 1;
            renderTable(currentPage, marca);
        }

        // Carrega dados ao abrir a página
        document.addEventListener("DOMContentLoaded", () => {
            fetchDataAndRenderTable(true); // Carregamento inicial da tabela
        });

        // Interação com o sidebar interno "registro-sidebar"
        const registroSidebarItems = document.querySelectorAll('.registro-sidebar ul li');
        registroSidebarItems.forEach(item => {
            item.addEventListener('click', () => {
                registroSidebarItems.forEach(i => i.classList.remove('selecionado'));
                item.classList.add('selecionado');
            });
        });

        function limparCamposFormulario() {
            document.getElementById('marca').value = '';
            document.getElementById('oQue').value = '';
            document.getElementById('como').value = '';
            document.getElementById('quem').value = '';
            document.getElementById('quando').value = '';
        }

        function submitAction() {
            const actionForm = document.getElementById('actionForm');
            const marca = actionForm.marca.value;
            const oQue = actionForm.oQue.value;
            const como = actionForm.como.value;
            const quem = actionForm.quem.value;
            const quando = actionForm.quando.value;

            if (!marca || !oQue || !como || !quem || !quando) {
                showToast("Por favor, preencha todos os campos.");
                return;
            }

            let formData = {
                marca: marca,
                oQue: oQue,
                como: como,
                quem: quem,
                quando: quando,
            };

            // Exibe a animação Lottie para outras operações
            const lottieOtherContainer = document.getElementById('lottieOtherContainer');
            lottieOtherContainer.classList.add('show');

            fetch('https://script.google.com/macros/s/AKfycbxA0tx3syUp1XAm4uOn28HkQwqB6vqWZmL0gyQ3C6Pbg3T_Bdq1xMCO8Le5O0WvOILrhg/exec', {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify(formData),
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(response => {
                console.log('Success:', response);
                closeModal();
                limparCamposFormulario(); // Limpa os campos do formulário
                fetchDataAndRenderTable(); // Atualiza a tabela após salvar
                showToast("Ação registrada com sucesso!");
            }).catch(error => {
                console.error('Error:', error);
                showToast("Ocorreu um erro ao registrar a ação.");
            }).finally(() => {
                // Oculta a animação Lottie após o processo
                lottieOtherContainer.classList.remove('show');
            });
        }

        function markAsCompleted(index) {
            const rowData = filteredRows[index]; // Obtém os dados da linha clicada
            const id = rowData[0]; // Supondo que o ID esteja na primeira coluna (coluna A)

            if (!id) {
                showToast("ID da linha não encontrado.");
                return;
            }

            // Obtém a data atual no formato YYYY-MM-DD
            const today = new Date().toISOString().split('T')[0];

            // Exibe a animação Lottie para outras operações
            const lottieOtherContainer = document.getElementById('lottieOtherContainer');
            lottieOtherContainer.classList.add('show');

            // Envia a requisição para o Google Apps Script
            fetch('https://script.google.com/macros/s/AKfycbyS90cnsNExqo9GdXmcfx8FF95QTZHBzegV6x55rWXseuECNL-YrwBUEr9J2Q0Ka_75Hg/exec', {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({
                    action: 'markAsCompleted',
                    id: id,
                    date: today
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => {
                    if (response.ok) {
                        showToast("Ação concluída com sucesso!");
                        fetchDataAndRenderTable(); // Atualiza a tabela após a conclusão
                    } else {
                        showToast("Ação concluída com sucesso!");
                        fetchDataAndRenderTable(); // Atualiza a tabela após a conclusão

                    }
                })
                .catch(error => {
                    console.error('Erro:', error);
                    showToast("Erro ao concluir a ação.");
                })
                .finally(() => {
                    // Oculta a animação Lottie após o processo
                    lottieOtherContainer.classList.remove('show');
                });
        }

        function deleteRow(index) {
            const rowData = filteredRows[index]; // Obtém os dados da linha clicada
            const id = rowData[0]; // Supondo que o ID esteja na primeira coluna (coluna A)

            if (!id) {
                showToast("ID da linha não encontrado.");
                return;
            }

            if (confirm("Tem certeza que deseja excluir esta ação?")) {
                // Exibe a animação Lottie para outras operações
                const lottieOtherContainer = document.getElementById('lottieOtherContainer');
                lottieOtherContainer.classList.add('show');

                // Envia a requisição para o Google Apps Script
                fetch('https://script.google.com/macros/s/AKfycbwMJFcdJraKsODfoSaAxsTlemdXAnHVWUuLe85tEra-kZjkY4aRm5atNXA0Opasvn4S9w/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify({
                        action: 'deleteRow',
                        id: id // Envia o ID da linha a ser excluída
                    }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                    .then(response => {
                        if (response.ok) {
                            showToast("Ação excluída com sucesso!");
                            fetchDataAndRenderTable(); // Atualiza a tabela após a exclusão
                        } else {
                            showToast("Ação excluída com sucesso!");
                            fetchDataAndRenderTable(); // Atualiza a tabela após a exclusão

                        }
                    })
                    .catch(error => {
                        console.error('Erro:', error);
                        showToast("Erro ao excluir a ação.");
                    })
                    .finally(() => {
                        // Oculta a animação Lottie após o processo
                        lottieOtherContainer.classList.remove('show');
                    });
            }
        }


        /////////////////// Acompanhamento////////////////////////////

        let dadosTabela = []; // Variável global para armazenar os dados da tabela
        let cabecalho = []; // Variável global para armazenar o cabeçalho da tabela

        // Função para carregar os dados da API do Google Apps Script
        async function carregarDadosPlanilha() {
            const url = "https://script.google.com/macros/s/AKfycbwESLf8Xf98nhKuSM9xwDBg0PUdnWfISKSRydtUOHh4po135_d6zmpWC-AFee2N4UiMEw/exec"; // URL do Web App

            try {
                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                dadosTabela = data; // Armazena os dados na variável global
                cabecalho = Object.keys(data[0]); // Armazena o cabeçalho
                console.log("Dados da API:", dadosTabela); // Debug
                criarTabelaComSubtotal(dadosTabela); // Cria a tabela com subtotais

            } catch (error) {
                console.error("Erro ao carregar os dados da API:", error);

                // Exibe uma mensagem de erro no container da tabela
                const containerTabela = document.getElementById("tabela-producao");
                containerTabela.innerHTML = `<p style="color: red; text-align: center;">Erro ao carregar os dados. Por favor, tente novamente mais tarde.</p>`;
            } finally {
                // Remove a animação de carregamento
                const loadingAnimation = document.querySelector(".loading-animation2");
                if (loadingAnimation) {
                    loadingAnimation.style.display = "none";
                }
            }
        }

        // Função para carregar os dados da planilha
        async function carregarDadosPlanilha2() {
            const url = "https://script.google.com/macros/s/AKfycbz6wo1LkiwLOInDyNJA0LAx0NtuMmVQpDr4jOdhPS0w0mcd3SxLbiSMopwqySG9lfg5Dw/exec"; // URL do Web App

            try {
                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`Erro na requisição: ${response.status} ${response.statusText}`);
                }

                const data = await response.json();
                console.log("Dados da API:", data); // Debug

                // Exibir a data e hora ao lado do título
                const dataHoraElement = document.getElementById("data-hora-registro");
                if (dataHoraElement && data.lastUpdated) {
                    const dataFormatada = new Date(data.lastUpdated).toLocaleString(); // Formata a data e hora
                    dataHoraElement.textContent = `Última atualização: ${dataFormatada}`;
                }

            } catch (error) {
                console.error("Erro ao carregar os dados da API:", error);

                // Exibe uma mensagem de erro
                const dataHoraElement = document.getElementById("data-hora-registro");
                if (dataHoraElement) {
                    dataHoraElement.textContent = "Erro ao carregar a data e hora.";
                    dataHoraElement.style.color = "red";
                }
            }
        }

        // Função para criar a tabela com subtotais e total geral
        function criarTabelaComSubtotal(dados) {
            if (!dados || dados.length === 0) {
                const containerTabela = document.getElementById("tabela-producao");
                containerTabela.innerHTML = `<p style="color: gray; text-align: center;">Nenhum dado disponível para exibição.</p>`;
                return;
            }

            const tabela = document.createElement("table");
            const thead = document.createElement("thead");
            const tbody = document.createElement("tbody");

            // Cabeçalho da tabela
            const trHead = document.createElement("tr");
            const thToggle = document.createElement("th"); // Coluna para o ícone de toggle
            thToggle.textContent = "Sub"; // Deixar vazio para o ícone
            trHead.appendChild(thToggle);
            cabecalho.forEach(coluna => {
                const th = document.createElement("th");
                th.textContent = coluna;
                trHead.appendChild(th);
            });
            thead.appendChild(trHead);
            tabela.appendChild(thead);

            let totalGeral = {}; // Objeto para armazenar o total geral por coluna numérica

            // Agrupa os dados por semana
            const dadosPorSemana = {};
            dados.forEach(linha => {
                const semana = linha["Semana"];
                if (!dadosPorSemana[semana]) {
                    dadosPorSemana[semana] = [];
                }
                dadosPorSemana[semana].push(linha);
            });

            // Preenche a tabela com os dados e subtotais
            Object.keys(dadosPorSemana).sort((a, b) => a - b).forEach(semana => {
                const linhasDaSemana = dadosPorSemana[semana];

                // Linha de subtotal
                const trSubtotal = document.createElement("tr");
                trSubtotal.setAttribute("data-semana", semana);
                trSubtotal.style.fontWeight = "bold";
                trSubtotal.style.backgroundColor = "#f0f0f0";

                const tdToggle = document.createElement("td");
                const iconToggle = document.createElement("i");
                iconToggle.classList.add("fas", "fa-angle-down", "toggle-icon");
                iconToggle.onclick = () => toggleSemana(semana);
                tdToggle.appendChild(iconToggle);
                trSubtotal.appendChild(tdToggle);

                cabecalho.forEach(coluna => {
                    const td = document.createElement("td");
                    if (coluna === "Semana") {
                        td.textContent = `Sem  ${semana}`;
                    } else if (!isNaN(parseFloat(linhasDaSemana[0][coluna]))) {
                        // Soma os valores da coluna se forem numéricos
                        const subtotal = linhasDaSemana.reduce((acc, linha) => acc + parseFloat(linha[coluna] || 0), 0);
                        td.textContent = Math.round(subtotal); // Exibe sem casas decimais
                        totalGeral[coluna] = (totalGeral[coluna] || 0) + subtotal; // Acumula para o total geral
                    } else {
                        td.textContent = "";
                    }
                    trSubtotal.appendChild(td);
                });
                tbody.appendChild(trSubtotal);

                // Linhas da semana (ocultas por padrão)
                linhasDaSemana.forEach(linha => {
                    const tr = document.createElement("tr");
                    tr.setAttribute("data-semana", semana);
                    tr.style.display = "none"; // Oculta as linhas detalhadas por padrão

                    const tdEmpty = document.createElement("td");
                    tdEmpty.textContent = ""; // Deixar vazio para alinhar com o ícone
                    tr.appendChild(tdEmpty);

                    cabecalho.forEach(coluna => {
                        const td = document.createElement("td");
                        if (!isNaN(parseFloat(linha[coluna]))) {
                            td.textContent = Math.round(linha[coluna]); // Exibe sem casas decimais
                        } else {
                            td.textContent = linha[coluna];
                        }
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            });

            // Linha de total geral
            const trTotal = document.createElement("tr");
            trTotal.classList.add("linha-total");

            const tdVazio = document.createElement("td");
            tdVazio.colSpan = 4; // Ocupa quatro colunas (ícone + "Semana" + "Marcas" + "Modelos")
            tdVazio.textContent = "Total Geral";
            trTotal.appendChild(tdVazio);

            cabecalho.forEach(coluna => {
                if (coluna !== "Semana" && coluna !== "Marcas" && coluna !== "Modelos" && !isNaN(parseFloat(totalGeral[coluna]))) {
                    const td = document.createElement("td");
                    td.textContent = Math.round(totalGeral[coluna]); // Exibe sem casas decimais
                    trTotal.appendChild(td);
                }
            });

            tbody.appendChild(trTotal); // Adiciona a linha de total geral

            tabela.appendChild(tbody);

            // Adicionar a tabela ao container
            const containerTabela = document.getElementById("tabela-producao");
            containerTabela.innerHTML = ""; // Limpa o conteúdo anterior
            containerTabela.appendChild(tabela);
        }

        // Função para alternar o estado de exibição das linhas de uma semana
        function toggleSemana(semana) {
            const linhas = document.querySelectorAll(`[data-semana="${semana}"]`);
            const primeiroElemento = linhas[0]; // Subtotal
            const iconeToggle = primeiroElemento.querySelector(".toggle-icon");

            linhas.forEach((linha, index) => {
                if (index > 0) { // Ignorar a linha de subtotal
                    if (linha.style.display === "none") {
                        linha.style.display = "table-row";
                        iconeToggle.classList.remove("fa-angle-up");
                        iconeToggle.classList.add("fa-angle-down");
                    } else {
                        linha.style.display = "none";
                        iconeToggle.classList.remove("fa-angle-down");
                        iconeToggle.classList.add("fa-angle-up");
                    }
                }
            });
        }

        // Função para filtrar a tabela
        function filtrarTabela2(filtro) {
            // Filtra os dados com base na coluna "Marcas"
            const dadosFiltrados = dadosTabela.filter(linha => linha["Marcas"] === filtro);
            console.log("Dados filtrados:", dadosFiltrados); // Debug

            // Recria a tabela com os dados filtrados
            criarTabelaComSubtotal(dadosFiltrados);

            // Remove a classe 'selecionado' de todos os blocos
            document.querySelectorAll('.acao-sidebar ul li').forEach(item => {
                item.classList.remove('selecionado');
            });

            // Adiciona a classe 'selecionado' ao bloco clicado
            const filtroElement = document.getElementById('filtro' + filtro);
            if (filtroElement) {
                filtroElement.classList.add('selecionado');
            }
        }

        // Adiciona um evento de clique para cada item do menu
        document.addEventListener('DOMContentLoaded', function () {
            const menuItems = document.querySelectorAll('.acao-sidebar ul li');

            menuItems.forEach(item => {
                item.addEventListener('click', function () {
                    // Remover a classe 'selecionado' de todos os itens
                    menuItems.forEach(menuItem => {
                        menuItem.classList.remove('selecionado');
                    });

                    // Adicionar a classe 'selecionado' ao item clicado
                    this.classList.add('selecionado');
                });
            });

            // Carrega os dados da planilha ao carregar a página
            carregarDadosPlanilha();
            carregarDadosPlanilha2();
        });



        ///////////////Calendario////////////////////
        let allData1 = {};
        let eventColors = {
            "LEAN": "#FF8C00",
            "QUALIDADE": "#00CC00",
            "RH": "#FF0080",
            "CRONO": "#BC8F8F",
            "MANUTENÇÃO": "#f3d500",
            "P5S": "#6959CD",
            "LABORATÓRIO": "#006600",
            "MODELAGEM": "#A0522D",
            "SSMA": "#BA55D3",
            "TO": "#1E90FF",
            "PCP": "#FF0000",
            "FERIADO": "#000000",
            "FERIADO": "#000000",
        };

        document.addEventListener('DOMContentLoaded', function () {
            const currentMonth = new Date().getMonth() + 1;
            document.getElementById('monthFilter1').value = currentMonth;
            fetchCalendarData();
        });

        function fetchCalendarData() {
            // Mostra o loader antes de iniciar o carregamento
            document.getElementById('lottieLoadingContainer2').style.display = 'flex';

            fetch('https://script.google.com/macros/s/AKfycbz4dnhdAYGL_HdHMO9ypsvNR7LmGxplWuyxNGllpzyI3PjKSD3zsdQz5_4AS8SE0mbL/exec')
                .then(response => response.json())
                .then(data => {
                    allData1 = data;
                    loadCalendar1();
                })
                .catch(error => console.error('Erro ao carregar o calendário:', error))
                .finally(() => {
                    // Oculta o loader após o carregamento
                    document.getElementById('lottieLoadingContainer2').style.display = 'none';
                });
        }

        function loadCalendar1() {
            const selectedMonth = parseInt(document.getElementById('monthFilter1').value);
            const calendarDiv = document.getElementById('calendar');
            calendarDiv.innerHTML = "";

            let table = "<table>";
            table += "<thead><tr><th>N° Sem</th><th>Segunda</th><th>Terça</th><th>Quarta</th><th>Quinta</th><th>Sexta</th></tr></thead><tbody>";

            const today = new Date();
            const currentDay = today.getDate();
            const currentMonth = today.getMonth() + 1; // Mês atual (1-12)

            Object.keys(allData1[selectedMonth] || {}).forEach(weekNumber => {
                let week = allData1[selectedMonth][weekNumber];

                table += `<tr>`;
                table += `<td class="week-number">${week.weekOfYear}</td>`;
                [1, 2, 3, 4, 5].forEach(day => {
                    let event = week.days[day]?.event || "";
                    let color = eventColors[event] || "#FFFFFF";
                    let dayNumber = week.days[day]?.dayNumber || "";
                    let isToday = (currentMonth === selectedMonth && dayNumber === currentDay);

                    let cellContent = week.days[day]
                        ? `<span class="date-number ${isToday ? 'pulse' : ''}">${dayNumber}</span><br><span class="event-text ${isToday ? 'pulse' : ''}">${event}</span>`
                        : "-";
                    table += `<td class="event-cell" style="background-color:${color};">${cellContent}</td>`;
                });
                table += `</tr>`;
            });

            table += "</tbody></table>";
            calendarDiv.innerHTML = table;
        }

        ///////////////////////////////////////////////////////////////Status////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        // Inicia a captura do input do código de barras
        document.addEventListener('DOMContentLoaded', function () {
            const barcodeInput = document.querySelector('.barcode-field input[type="text"]');

            barcodeInput.addEventListener('keypress', function (event) {
                const barcodeValue = event.target.value;

                // Verifica se a tecla pressionada foi 'Enter' (tecla que o leitor geralmente usa após o código de barras)
                if (event.key === 'Enter' && barcodeValue) {
                    console.log("Código de barras enviado para a API: ", barcodeValue);  // Log do valor enviado
                    fetchDataAndSave(barcodeValue);  // Envia o código para a API
                    barcodeInput.value = '';  // Limpa o campo de entrada após o envio
                }
            });
            buscarEventoDoDia();
        });

        function handleApiResponse(data) {
            if (data.status === 'error') {
                let message = '';
                let feedbackType = ''; // Inicializa o tipo de feedback

                if (data.message === 'Gerenciamento diário Fechado') {
                    message = 'Gerenciamento diário Fechado';
                    feedbackType = 'info';  // Azul para "Gerenciamento diário Fechado"
                } else if (data.message === 'Crachá não encontrado.') {
                    message = 'Crachá não encontrado';
                    feedbackType = 'warning'; // Amarelo para "Crachá não encontrado"
                } else {
                    message = 'Erro ao buscar dados';
                    feedbackType = 'error'; // Vermelho para "Erro ao buscar dados"
                }

                showFeedback(message, feedbackType); // Exibe a mensagem com o tipo adequado
            } else {
                // Caso contrário, exibe a mensagem de sucesso com cor verde
                showFeedback('Dados salvos com sucesso', 'success');
            }
        }

        // Função para exibir feedback
        function showFeedback(message, type) {
            const feedback = document.getElementById('feedback');
            feedback.textContent = message;

            // Remove as classes anteriores
            feedback.classList.remove('success', 'warning', 'error', 'info');

            // Adiciona a classe correspondente ao tipo de feedback
            feedback.classList.add(type);

            feedback.style.display = 'block';
            feedback.style.opacity = '1';

            // Limpa o input
            document.getElementById('barcodeInput').value = '';

            // Oculta o feedback após 5 segundos com efeito de fade out
            setTimeout(() => {
                feedback.style.opacity = '0';
                setTimeout(() => {
                    feedback.style.display = 'none';
                }, 1000); // Tempo do fade out
            }, 2000); // Tempo de exibição do feedback
        }

        // Função para buscar os dados na API usando o parâmetro "barcode"

        function fetchDataAndSave(barcode) {
            const url = `https://script.google.com/macros/s/AKfycbyrSe11utS7I9Y8NO_lhdaBF2Bi_5MWXjVfGPLvBl2vpziNz9I58A4ckzKVzccd6kmx/exec?barcode=${barcode}`;
            console.log("Código de barras enviado para a API: ", barcode);  // Log do valor enviado

            fetch(url)
                .then(response => {
                    console.log('Status da resposta da API: ', response.status); // Log do status da resposta
                    if (!response.ok) {
                        throw new Error('Erro na requisição: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Dados recebidos:', data);  // Log dos dados recebidos da API

                    if (data.status === 'error') {
                        // Chama a função para exibir feedback conforme o tipo de erro
                        handleApiResponse(data);  // Exibe a mensagem adequada com base no status e mensagem de erro
                    } else if (data.status === 'success' && data.data) {
                        const fetchedCracha = data.data.cracha.toString().trim();
                        const barcodeToCheck = barcode.trim();
                        console.log("Cracha comparado: ", fetchedCracha, " Barcode recebido: ", barcodeToCheck);  // Log para ver os valores sendo comparados

                        if (fetchedCracha === barcodeToCheck) {
                            saveDataToSheet(data.data);  // Salva os dados e exibe a mensagem de sucesso
                        } else {
                            handleApiResponse({ status: 'error', message: 'Crachá não encontrado.' });  // Exibe a mensagem de erro se o código não for encontrado
                            console.log("Código de barras não encontrado.");  // Log se não encontrar o código
                        }
                    } else {
                        // Caso o status não seja 'success' ou o campo 'data' esteja vazio, trata como não encontrado
                        handleApiResponse({ status: 'error', message: 'Crachá não encontrado.' });  // Exibe a mensagem de erro se não encontrar dados válidos
                        console.log("Código de barras não encontrado, status ou data ausente.");  // Log de erro específico
                    }
                })
                .catch(error => {
                    console.error('Erro ao buscar dados:', error);  // Log de erro geral
                    handleApiResponse({ status: 'error', message: 'Erro ao buscar dados.' });  // Exibe erro genérico ao buscar dados
                });
        }

        // Função para salvar os dados na planilha "base_dados_status"
        function saveDataToSheet(data) {
            const urlPost = 'https://script.google.com/macros/s/AKfycbyrSe11utS7I9Y8NO_lhdaBF2Bi_5MWXjVfGPLvBl2vpziNz9I58A4ckzKVzccd6kmx/exec';
            const postData = {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'saveStatus',
                    dataAtual: new Date().toLocaleDateString('pt-BR'), // Data atual formatada como dd/mm/aa
                    cracha: data.cracha,
                    nome: data.Nome,
                    celula: data.Célula,
                    funcao: data.Função,
                    setor: data.Setor,
                    predio: data.Predio,


                })
            };
            fetch(urlPost, postData)
                .then(response => {
                    console.log('Dados enviados para salvar.');
                    // Exibe a mensagem de sucesso com o nome incluído
                    showFeedback(`${data.Nome}`, 'success');
                    applyColor(); // Aplica a cor verde para os nomes com data de hoje na aba 'Base_Dados_Status'
                })
                .catch(error => {
                    console.error('Erro ao salvar dados:', error);
                    showFeedback('Erro ao salvar dados.', 'error');
                });
        }

        ////////////////////////////////////////// Calendario do dia - Status/////////////////////////////////////////////////////////////

        // Função para buscar o evento do dia na API de eventos
        function buscarEventoDoDia() {
            const dataAtual = new Date();
            const dia = String(dataAtual.getDate()).padStart(2, '0');
            const mesComZero = String(dataAtual.getMonth() + 1).padStart(2, '0');
            const ano = dataAtual.getFullYear();
            const dataFormatada = `${dia}/${mesComZero}/${ano}`;
            // Mapeamento de eventos para cores
            const coresEventos = {
                "LEAN": "#FF8C00",
                "QUALIDADE": "#00CC00",
                "RH": "#FF0080",
                "CRONO": "#BC8F8F",
                "MANUTENÇÃO": "#f3d500",
                "P5S": "#6959CD",
                "LABORATÓRIO": "#006600",
                "MODELAGEM": "#A0522D",
                "SSMA": "#BA55D3",
                "TO": "#1E90FF",
                "PCP": "#FF0000",
                "FERIADO": "#000000",
                "-": "#ccc"  // Cor padrão caso não haja mapeamento
            };

            const url = 'https://script.google.com/macros/s/AKfycbz4dnhdAYGL_HdHMO9ypsvNR7LmGxplWuyxNGllpzyI3PjKSD3zsdQz5_4AS8SE0mbL/exec';
            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Erro na requisição: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Evento recebido:', data);
                    if (data && typeof data === 'object') {
                        const mesAtual = data[mesComZero] || data[String(dataAtual.getMonth() + 1)];
                        if (mesAtual) {
                            let eventoDoDia = null;
                            Object.keys(mesAtual).forEach(semana => {
                                const dias = mesAtual[semana].days;
                                Object.keys(dias).forEach(diaKey => {
                                    if (dias[diaKey] && dias[diaKey].date === dataFormatada) {
                                        eventoDoDia = dias[diaKey].event;
                                    }
                                });
                            });
                            const elementoEvento = document.getElementById('eventoDoDia');
                            const container4 = document.querySelector('.container4');
                            if (eventoDoDia) {
                                elementoEvento.textContent = eventoDoDia;
                                const corEvento = coresEventos[eventoDoDia] || coresEventos["-"];
                                container4.style.backgroundColor = corEvento;
                            } else {
                                elementoEvento.textContent = 'Nenhum evento.';
                                container4.style.backgroundColor = coresEventos["-"];
                            }
                        } else {
                            throw new Error('Mês atual não encontrado nos dados.');
                        }
                    } else {
                        throw new Error('Formato de dados inválido.');
                    }
                })
                .catch(error => {
                    console.error('Erro ao buscar evento:', error);
                    document.getElementById('eventoDoDia').textContent = 'Erro ao carregar';
                    document.querySelector('.container4').style.backgroundColor = coresEventos["-"];
                });
        }

        ///////////////////////////////////////////////// Presença do dia ///////////////////////////////////////////////////////////////////////////////////////////////////////////


        // Função para buscar os dados da aba 'Calendário' (nomes)
        async function fetchNames() {
            const url = 'https://script.google.com/macros/s/AKfycbyFB2Lf8uT3mvr4dK2ufCZMyglBdhouc-6pLaBuIccAWJvTZi9QUEhYv75RMlXf_hUq/exec?action=load'; // URL para carregar os nomes da aba 'Calendário'
            try {
                const response = await fetch(url);
                const data = await response.json();

                // Exibe os dados nos quadrados
                const quadradosContainer = document.getElementById('quadradosContainer');
                quadradosContainer.innerHTML = ''; // Limpa antes de adicionar novos dados

                // Adiciona os quadrados com os nomes
                data.data.forEach((name) => {
                    if (name.toLowerCase() !== "feriado") { // Ignora o nome "Feriado"
                        const quadrado = document.createElement('div');
                        quadrado.className = 'quadrado';
                        quadrado.textContent = name;
                        quadradosContainer.appendChild(quadrado);
                    }
                });
            } catch (error) {
                console.error('Erro ao buscar dados:', error);
            }
        }

        // Função para aplicar a cor verde aos quadrados de hoje
        async function applyColor() {
            const url = 'https://script.google.com/macros/s/AKfycbyFB2Lf8uT3mvr4dK2ufCZMyglBdhouc-6pLaBuIccAWJvTZi9QUEhYv75RMlXf_hUq/exec?action=color'; // URL para aplicar cor
            try {
                const response = await fetch(url);
                const data = await response.json();

                // Recupera a lista de nomes que devem ser destacados com a cor verde
                const namesWithGreen = data.data;

                const quadradosContainer = document.getElementById('quadradosContainer');
                const quadrados = quadradosContainer.getElementsByClassName('quadrado');

                // Adiciona a classe 'green' para os quadrados de nomes com a data de hoje
                for (let i = 0; i < quadrados.length; i++) {
                    const quadrado = quadrados[i];
                    if (namesWithGreen.includes(quadrado.textContent)) {
                        quadrado.classList.add('green'); // Aplica a classe 'green' para o quadrado
                    }
                }
            } catch (error) {
                console.error('Erro ao aplicar cor:', error);
            }
        }

        ////////////////////////////////////////////// Historico ////////////////////////////////////////////////////////

        // Chama as funções quando a página carregar
        window.onload = () => {
            fetchNames(); // Carrega os nomes da aba 'Calendário'
            applyColor(); // Aplica a cor verde para os nomes com data de hoje na aba 'Base_Dados_Status'
        };
        // Variáveis globais
        let allData2 = [];
        let currentMonthFilter = '';
        let currentBrandFilter = 'Asics'; // Definindo Asics como marca padrão
        let availableBrands = [];

        function showPage(page) {
            var sections = document.querySelectorAll('.page');
            sections.forEach(function (section) {
                section.classList.remove('active');
            });
            var activePage = document.getElementById(page);
            activePage.classList.add('active');
            var navItems = document.querySelectorAll('nav ul li');
            navItems.forEach(function (item) {
                item.classList.remove('active');
            });
            var activeNavItem = document.getElementById(page + "Nav");
            activeNavItem.classList.add('active');
        }

        function getCurrentMonthYear() {
            const now = new Date();
            const year = now.getFullYear();
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            return `${year}-${month}`;
        }

        async function loadPresenceData() {
            try {
                document.getElementById('table-container').innerHTML = '<div class="loading"></div>';

                const response = await fetch('https://script.google.com/macros/s/AKfycbyrQHwDJxexVSvf8zzD1au6_2y-3rnybawYkMFSsNX-rRMt-zUohlucvYYITzFpYWw/exec');
                const jsonData = await response.json();

                if (jsonData.success && jsonData.data) {
                    allData2 = processData(jsonData.data);

                    // Extrai as marcas únicas da API (verificando variações de nome)
                    availableBrands = [...new Set(allData2.map(item => {
                        // Verifica diferentes padrões de nome para marca
                        return item.MARCA || item.Marca || item.marca || 'N/A';
                    }))].filter(brand => brand !== 'N/A').sort();

                    populateFilters();
                    applyFilters();
                } else {
                    throw new Error('Estrutura de dados inválida');
                }
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                document.getElementById('table-container').innerHTML = '<p>Erro ao carregar dados. Por favor, tente novamente mais tarde.</p>';
            }
        }

        function processData(data) {
            return data.map(item => {
                const dateObj = new Date(item.Data);
                const month = dateObj.getMonth() + 1;
                const year = dateObj.getFullYear();
                const monthYear = `${year}-${month.toString().padStart(2, '0')}`;
                const dateStr = dateObj.toISOString().split('T')[0];

                // Verifica diferentes padrões de nome para marca
                const marca = item.MARCA || item.Marca || item.marca || 'N/A';

                return {
                    ...item,
                    monthYear: monthYear,
                    dateOnly: dateStr,
                    dateObj: dateObj,
                    marca: marca // Usa o valor encontrado
                };
            });
        }

        function populateFilters() {
            // Popula filtro de meses
            const monthSet = new Set(allData2.map(item => item.monthYear));
            const monthFilter = document.getElementById('monthFilter2');
            monthFilter.innerHTML = '';

            const monthsArray = Array.from(monthSet).sort((a, b) => b.localeCompare(a));
            monthsArray.forEach(monthYear => {
                const [year, month] = monthYear.split('-');
                const monthName = new Date(year, month - 1, 1).toLocaleDateString('pt-BR', { month: 'long' });
                const option = document.createElement('option');
                option.value = monthYear;
                option.textContent = `${monthName}/${year}`;
                monthFilter.appendChild(option);
            });

            // Define o mês atual como padrão
            const currentMonthYear = getCurrentMonthYear();
            currentMonthFilter = monthsArray.includes(currentMonthYear) ? currentMonthYear : monthsArray[0];
            monthFilter.value = currentMonthFilter;

            // Popula filtro de marcas
            const brandFilter = document.getElementById('brandFilter');
            brandFilter.innerHTML = '';

            // Verifica se Asics existe nas marcas disponíveis
            const asicsExists = availableBrands.includes('Asics');

            // Seleciona Asics por padrão se existir, caso contrário seleciona a primeira marca
            currentBrandFilter = asicsExists ? 'Asics' : availableBrands[0];

            availableBrands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandFilter.appendChild(option);
            });

            // Define o valor selecionado
            brandFilter.value = currentBrandFilter;

            // Event listeners para filtros
            monthFilter.addEventListener('change', function () {
                currentMonthFilter = this.value;
                applyFilters();
            });

            brandFilter.addEventListener('change', function () {
                currentBrandFilter = this.value;
                applyFilters();
            });
        }

        function applyFilters() {
            // Filtra por mês
            let filteredData = allData2.filter(item => item.monthYear === currentMonthFilter);

            // Filtra por marca
            filteredData = filteredData.filter(item => item.marca === currentBrandFilter);

            createTable(filteredData);
        }

        function getPercentageClass(percentage) {
            if (percentage >= 90) return 'percent-blue';
            if (percentage >= 80) return 'percent-green';
            if (percentage >= 70) return 'percent-yellow';
            return 'percent-red';
        }

        function createTable(data) {
            // Limpa o container da tabela
            const tableContainer = document.getElementById('table-container');
            tableContainer.innerHTML = '';

            // Verifica se há dados para exibir
            if (data.length === 0) {
                tableContainer.innerHTML = '<p>Nenhum dado disponível para os filtros selecionados.</p>';
                return;
            }

            // Agrupa dados por data, turno e setor
            const datesGrouped = {};
            const dateSet = new Set();
            const turnoPresence = { A: {}, B: {} };
            const setorTurnoPresence = {};
            const setorCounts = {};

            // Processa todos os dados para agrupamento
            data.forEach(item => {
                const date = item.dateOnly;
                const turno = item.Turno;
                const setor = item.SETOR;

                dateSet.add(date);

                // Inicializa estruturas se necessário
                if (!datesGrouped[date]) datesGrouped[date] = {};
                if (!datesGrouped[date][turno]) datesGrouped[date][turno] = {};
                if (!datesGrouped[date][turno][setor]) {
                    datesGrouped[date][turno][setor] = new Set();
                }

                // Adiciona o nome ao conjunto
                datesGrouped[date][turno][setor].add(item.NOME);

                // Contabiliza presença por turno
                if (turno === 'A' || turno === 'B') {
                    if (!turnoPresence[turno][date]) {
                        turnoPresence[turno][date] = 0;
                    }
                    turnoPresence[turno][date]++;

                    // Contabiliza presença por setor e turno
                    if (!setorTurnoPresence[setor]) {
                        setorTurnoPresence[setor] = { A: {}, B: {} };
                    }
                    if (!setorTurnoPresence[setor][turno][date]) {
                        setorTurnoPresence[setor][turno][date] = 0;
                    }
                    setorTurnoPresence[setor][turno][date]++;
                }

                // Conta quantos dias cada setor aparece
                if (!setorCounts[setor]) {
                    setorCounts[setor] = { A: 0, B: 0 };
                }
                setorCounts[setor][turno]++;
            });

            // Ordena as datas
            const uniqueDates = Array.from(dateSet).sort((a, b) => new Date(a) - new Date(b));
            const allSetores = Object.keys(setorCounts).sort();
            const allTurnos = ['A', 'B']; // Assumindo que só temos turnos A e B

            // Função para formatar a data
            const formatDate = (dateStr) => {
                const [year, month, day] = dateStr.split('-');
                return `${day}/${month}`;
            };

            // Função para calcular frequência
            const calculateFrequency = (presenceObj, totalDates) => {
                const presentDays = Object.keys(presenceObj).length;
                return totalDates > 0 ? Math.round((presentDays / totalDates) * 100) : 0;
            };

            const totalDates = uniqueDates.length;

            // Cria a tabela
            const table = document.createElement('table');
            table.className = 'dynamic-table';

            // Cria o cabeçalho
            const thead = document.createElement('thead');
            let headerRow1 = document.createElement('tr');
            let headerRow2 = document.createElement('tr');

            // Célula do setor
            const setorHeader = document.createElement('th');
            setorHeader.rowSpan = 2;
            setorHeader.className = 'setor-header';
            setorHeader.textContent = 'Setor';
            headerRow1.appendChild(setorHeader);

            // Células de datas
            uniqueDates.forEach(date => {
                const dateHeader = document.createElement('th');
                dateHeader.colSpan = allTurnos.length;
                dateHeader.className = 'date-header';
                dateHeader.textContent = formatDate(date);
                headerRow1.appendChild(dateHeader);
            });

            // Célula de presença
            const freqHeader = document.createElement('th');
            freqHeader.rowSpan = 2;
            freqHeader.className = 'total-header';
            freqHeader.textContent = 'Presença';
            headerRow1.appendChild(freqHeader);

            // Subcabeçalho com turnos
            uniqueDates.forEach(() => {
                allTurnos.forEach(turno => {
                    const turnoHeader = document.createElement('th');
                    turnoHeader.className = 'turno-header';
                    turnoHeader.textContent = turno;
                    headerRow2.appendChild(turnoHeader);
                });
            });

            thead.appendChild(headerRow1);
            thead.appendChild(headerRow2);
            table.appendChild(thead);

            // Cria o corpo da tabela
            const tbody = document.createElement('tbody');

            // Linhas para cada setor
            allSetores.forEach(setor => {
                const row = document.createElement('tr');

                // Célula do setor
                const setorCell = document.createElement('td');
                setorCell.className = 'setor-cell';
                setorCell.textContent = setor;
                row.appendChild(setorCell);

                // Células de presença por data e turno
                uniqueDates.forEach(date => {
                    allTurnos.forEach(turno => {
                        const count = datesGrouped[date]?.[turno]?.[setor]?.size || 0;
                        const cell = document.createElement('td');
                        cell.className = count > 0 ? 'presente' : 'ausente';

                        if (count > 0) {
                            const checkIcon = document.createElement('span');
                            checkIcon.className = 'icone-check';
                            checkIcon.innerHTML = '✓';
                            cell.textContent = '';
                            cell.appendChild(checkIcon);
                        } else {
                            const xIcon = document.createElement('span');
                            xIcon.className = 'icone-x';
                            xIcon.innerHTML = '✗';
                            cell.textContent = '';
                            cell.appendChild(xIcon);
                        }

                        row.appendChild(cell);
                    });
                });

                // Cálculo das frequências por turno
                const freqA = calculateFrequency(setorTurnoPresence[setor]?.A || {}, totalDates);
                const freqB = calculateFrequency(setorTurnoPresence[setor]?.B || {}, totalDates);

                // Célula de presença
                const freqCell = document.createElement('td');
                freqCell.className = 'percentage-cell';

                const divA = document.createElement('div');
                divA.className = `percentage-row ${getPercentageClass(freqA)}`;
                divA.textContent = `A: ${freqA}%`;

                const divB = document.createElement('div');
                divB.className = `percentage-row ${getPercentageClass(freqB)}`;
                divB.textContent = `B: ${freqB}%`;

                freqCell.appendChild(divA);
                freqCell.appendChild(divB);
                row.appendChild(freqCell);

                tbody.appendChild(row);
            });

            table.appendChild(tbody);
            tableContainer.appendChild(table);

            // Ajusta a coluna Setor ao conteúdo
            adjustSetorColumnWidth();
        }
        function adjustSetorColumnWidth() {
            const setorCells = document.querySelectorAll('.setor-cell, .setor-header');
            let maxWidth = 0;

            // Encontra a largura máxima necessária
            setorCells.forEach(cell => {
                const width = cell.scrollWidth;
                if (width > maxWidth) {
                    maxWidth = width;
                }
            });

            // Aplica a largura máxima a todas as células de setor
            setorCells.forEach(cell => {
                cell.style.width = `${maxWidth + 10}px`; // Adiciona 10px de padding
                cell.style.minWidth = `${maxWidth + 10}px`;
            });
        }
        // Adicionar listener para redimensionamento da janela
        window.addEventListener('resize', () => {
            adjustSetorColumnWidth();
        });

        // Adicionar foco automático no campo de código de barras
        document.addEventListener('DOMContentLoaded', () => {
            loadPresenceData();
            document.getElementById('barcodeInput')?.focus();

            // Adicionar evento para tecla Enter no campo de código de barras
            const barcodeInput = document.getElementById('barcodeInput');
            if (barcodeInput) {
                barcodeInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        processBarcode(barcodeInput.value);
                        barcodeInput.value = '';
                    }
                });
            }
        });

        function processBarcode(code) {
            // Implementar lógica de processamento do código de barras
            console.log('Código de barras lido:', code);
            // Aqui você pode adicionar a lógica para processar o código de barras
            // e atualizar a interface conforme necessário
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadPresenceData();
        });
    </script>
</body>

</html>
